!function(){"use strict";angular.module("greenspotStall",["ngMaterial","ngMessages"]).config(["$locationProvider","$mdThemingProvider","$mdIconProvider",function(e,t,o){t.theme("default").primaryPalette("teal").accentPalette("lime"),o.defaultIconSet("/static/img/icon/core-icons.svg",24),e.html5Mode(!0)}])}(),function(){"use strict";function e(e,o,r){var i=this;i.gotoUrl=function(e){window.location.href=e},i.init=function(){i.cart.loadFromCookie()},i.cart={stls:[],qty:0,selectStall:function(e){i.order.stall=e},add:function(e){this.qty++;var o=!1;if($.each(this.stls,function(t,r){return r.i==e.stallId?(o=!0,r.add(e),!1):void 0}),!o){var r=new t(e.stallId,e.stallName);r.add(e),this.stls.push(r)}this.writeToCookie()},empty:function(){this.stls=[],this.qty=0,Cookies.remove("cart")},remove:function(e,t){if(this.qty-=e.remove(t),0==e.itms.length){var o=this.stls.indexOf(e);o>-1&&this.stls.splice(o,1)}this.writeToCookie()},plusOne:function(e,t){e.plusOne(t),this.qty++,this.writeToCookie()},minusOne:function(e,t){e.minusOne(t),this.qty--,this.writeToCookie()},loadFromCookie:function(){var e=Cookies.get("cart");if(e){var o=$.parseJSON(e);this.stls=[],$.each(o.stls,function(e,o){var r=new t(o.i,o.n);r.qty=o.qty,r.amt=o.amt,r.itms=o.itms,i.cart.stls.push(r)}),this.qty=o.qty,i.order.stall=i.cart.stls[0]}},writeToCookie:function(){Cookies.set("cart",this,{expires:14})}},i.checkOut=function(){e.post("/customer/CheckStock",i.order).success(function(e){e.Succeeded?window.location.href="/customer/Checkout":console.log(e.Message)}).error(function(e){console.log(e)})},i.init_checkout=function(e){i.order=e,i.loadDeliveryAddress()},i.order={},i.loadDeliveryAddress=function(){e.get("/customer/DeliveryAddresses").success(function(e){e.Succeeded?(i.deliveryAddresses=e.Data,i.order.deliveryAddress=i.deliveryAddresses[0],i.loadDeliverySchedule()):console.log(e.Message)}).error(function(e){console.log(e)})},i.loadDeliverySchedule=function(){var t="/api/stall/DeliverySchedule/"+i.order.stall.i+"?country="+i.order.deliveryAddress.CountryId;t+="&city="+i.order.deliveryAddress.City,t+="&area="+i.order.deliveryAddress.Area,e.get(t).success(function(e){e.Succeeded?(i.deliverySchedule=e.Data,i.order.deliveryOption=i.deliverySchedule[0],i.SelectDeliveryOption()):(r.alert(e.Message),console.log(e.Message))}).error(function(e){console.log(e)})},i.getDeliveryFee=function(){if(i.order.deliveryFee=null,i.order.deliveryOption.IsPickUp)i.order.deliveryFee=0,i.order.amount=i.order.stall.amt+i.order.deliveryFee;else{var t="/api/stall/CalcDeliveryFee/"+i.order.stall.i+"?country="+i.order.deliveryAddress.CountryId;t+="&city="+i.order.deliveryAddress.City,t+="&suburb="+i.order.deliveryAddress.Suburb,t+="&amount="+i.order.stall.amt,e.get(t).success(function(e){e.Succeeded?(i.order.deliveryFee=e.Data,i.order.amount=i.order.stall.amt+i.order.deliveryFee):(r.alert(e.Message),console.log(e.Message))}).error(function(e){console.log(e)})}},i.SelectDeliveryAddress=function(){i.loadDeliverySchedule()},i.SelectDeliveryOption=function(){i.getDeliveryFee()},i.pay=function(){console.log(i.order),e.post("/customer/Pay",i.order).success(function(e){e.Succeeded?window.location.href="/customer/orders":console.log(e.Message)}).error(function(e){console.log(e)})}}function t(e,t){var o=this;o.i=e,o.n=t,o.qty=0,o.amt=0,o.itms=[],o.add=function(e){o.qty++,o.amt+=e.price;var t=!1;$.each(o.itms,function(o,r){return r.i==e.id?(r.q++,t=!0,!1):void 0}),t||o.itms.push({i:e.id,n:e.name,v:e.variant,q:1,p:e.price})},o.remove=function(e){var t=0;return $.each(o.itms,function(r,i){if(i.i==e){var s=o.itms.indexOf(i);return s>-1&&o.itms.splice(s,1),t=i.q,o.qty-=i.q,o.amt-=i.p*i.q,!1}}),t},o.plusOne=function(e){$.each(o.itms,function(t,r){r.i==e&&r.q<99&&(r.q++,o.qty++,o.amt+=r.p)})},o.minusOne=function(e){$.each(o.itms,function(t,r){r.i==e&&r.q>0&&(r.q--,o.qty--,o.amt-=r.p)})}}var o=angular.module("greenspotStall");o.controller("CustomerController",e),e.$inject=["$http","$location","$window"]}(),function(){"use strict";function e(e,t){var o=this;o.gotoUrl=function(e){window.location.href=e},o.Register=function(){e.post("/owner/Register",this.OwnerInfo).success(function(e){e.Succeeded?window.location.href=e.Data:console.log(e.Message)}).error(function(e){console.log(e)})}}var t=angular.module("greenspotStall");t.controller("OwnerController",e),e.$inject=["$http","$location"]}();
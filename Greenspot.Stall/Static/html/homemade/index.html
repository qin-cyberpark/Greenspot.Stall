<!DOCTYPE html>
<html lang="en" ng-app="greenspotStall" ng-cloak>
<head>
    <meta charset="utf-8">
    <meta name="description" content="外卖 Takeaway Homemade">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <base href="/">
    <title>私房自助 | 久等了</title>
    <link rel="shortcut icon" href="/static/img/favicon.png">
    <!-- 3rd party stylesheet -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/angular-material/1.1.0-rc4/angular-material.min.css">
    <!-- platform stylesheet -->
    <link rel="stylesheet/less" href="/Content/less/global.less">
    <link rel="stylesheet/less" href="/Content/less/home.less">
    <!--link rel="stylesheet" href="/static/css/stall.min.css"-->
</head>
<body ng-controller="HomeController as homeCtrl" ng-init="homeCtrl.init('H')">
    <div id="search-bar">
        <select ng-model="homeCtrl.searchCondition.area">
            <option value="NZ-Auckland">奥克兰</option>
        </select>
        <input class="search-text" type="text" placeholder="搜索" ng-model="homeCtrl.searchCondition.keyword">
        <md-button class="btn-search" aria-label="Search" ng-click="homeCtrl.search()">
            <md-icon md-svg-icon="search"></md-icon>
        </md-button>
    </div>

    <!-- recommend stall -->
    <div class="content-with-bottom-bar" ng-if="homeCtrl.isRecommend && homeCtrl.recommendStalls.length">
        <div class="section-caption">最新 | 推荐</div>
        <md-card ng-repeat="stall in homeCtrl.recommendStalls" ng-click="gotoUrl('/stall/index/' + stall.Id)">
            <md-card-title>
                <md-card-title-text layout-align="space-between center">
                    <span class="md-headline">{{stall.Name}}</span>
                    <span class="md-subhead" ng-repeat="product in stall.Products">
                        {{product.Name}}
                    </span>
                </md-card-title-text>
                <md-card-title-media>
                    <div class="md-media-md card-media">
                        <img src="/Static/img/stall/{{stall.Id}}.jpg" />
                    </div>
                </md-card-title-media>
            </md-card-title>
        </md-card>
    </div>

    <!-- no recommend stall -->
    <div class="section-caption" ng-if="homeCtrl.isRecommend && !homeCtrl.recommendStalls.length">
        Coming Soon
    </div>

    <!-- search -->
    <md-tabs id="search-result" md-border-bottom md-stretch-tabs="always" ng-if="homeCtrl.matchedStalls || homeCtrl.matchedProducts">
        <!-- product search result -->
        <md-tab label="商品" ng-if="homeCtrl.matchedProducts">
            <div class="ProductList">
                <div class="item" ng-repeat="product in homeCtrl.matchedProducts">
                    <div class="left">
                        <img src="{{product.Image}}" ng-click="gotoUrl('/product/detail/' + product.Id)" />
                    </div>
                    <div class="right">
                        <div class="product-name" ng-click="gotoUrl('/product/detail/' + product.Id)">{{product.Name}}</div>
                        <div class="stall-name">{{product.StallName}}</div>
                        <div class="price">{{product.Price|currency:$}}</div>
                        <div class="operation">
                            <select ng-model="product.Quantity">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                            <button ng-click="homeCtrl.cart.add({stallId:product.StallId, stallName:product.StallName,
                                                id:product.Id, name:product.Name,price:product.Price, variant:''}, product.Quantity)">
                                加入购物车
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="section-caption" ng-if="!homeCtrl.matchedProducts.length">
                换个关键字试试？
            </div>
        </md-tab>
        <!-- product stall result -->
        <md-tab label="商铺" ng-if="homeCtrl.matchedStalls">
            <md-list flex ng-if="homeCtrl.matchedStalls.length">
                <md-list-item class="md-2-line" ng-repeat="stall in homeCtrl.matchedStalls" ng-click="gotoUrl('/stall/index/' + stall.Id)">
                    <img ng-src="/Static/img/stall/{{stall.Id}}.jpg" class="md-avatar" alt="{{stall.Name}}" />
                    <div class="md-list-item-text">
                        <h3>{{stall.Name}}</h3>
                    </div>
                </md-list-item>
            </md-list>

            <div class="section-caption" ng-if="!homeCtrl.matchedStalls.length">
                换个关键字试试？
            </div>
        </md-tab>
    </md-tabs>

    <!--bottom tool bar-->
    <div id="bottom-toolbar">
        <md-button class="btn-cart" aria-label="Cart" ng-click="gotoUrl('/customer/cart')" flex="60">
            <span class="cart-amount" ng-if="homeCtrl.cart.qty>0">{{homeCtrl.cart.qty}}</span>
            <md-icon md-svg-icon="cart"></md-icon>
            <span class="total-amount">合计: {{homeCtrl.cart.totalAmount()|currency:$}}</span>
        </md-button>
        <button ng-click="gotoUrl('/customer/cart')" class="btn btn-primary" ng-class="{'invalid':homeCtrl.cart.qty<=0}" flex
                ng-disabled="homeCtrl.cart.qty<=0">
            结账
        </button>
    </div>
    <div class="loading-circle big screen-center" ng-if="loadingCircle">
        <img src="/Static/img/loading.gif" />
    </div>

    <!-- 3rd party libraries -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular-route.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular-aria.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular-animate.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular-messages.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular-material/1.1.0-rc4/angular-material.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.2/js.cookie.min.js"></script>

    <!-- owner scripts -->
    <script type="text/javascript" src="/static/lib/less/dist/less.min.js"></script>
    <script type="text/javascript" src="/Content/middle-js/app.js"></script>
    <script type="text/javascript" src="/Content/middle-js/cart.js"></script>
    <script type="text/javascript" src="/Content/middle-js/order.js"></script>
    <script type="text/javascript" src="/Content/middle-js/controller/home.controller.js"></script>

    <!-- End Browser Link -->

</body>
</html>